# JavaScript - 생성자 함수에 의한 객체 생성

## 설명

### Object 생성자 함수

- new 연산자와 함께 Object 생성자 함수를 호출하면 빈 객체를 생성하여 반환합니다.
- 빈 객체를 생성한 이후로 프로퍼티 또는 메서드를 추가하여 객체를 완성할 수 있습니다.

```js
// 빈 객체의 생성
const person = new Object();

// 프로퍼티 추가
person.name = "Lee";
```

- 생성자 함수란 new 연산자와 함께 호출하여 객체를 생성하는 함수를 말합니다.
- 생성자 함수에 의해 생성된 객체를 인스턴스라 합니다.

### 생성자 함수

- 객체 리터럴에 의한 객체 생성 방식은 단 하나의 객체만 생성합니다.
- 따라서 동일한 프로퍼티를 갖는 객체를 여러 개 생성해야 하는 경우 매번 같은 프로퍼티를 기술해야 하기 때문에 비효율적입니다.

- 생성자 함수에 의한 객체 생성 방식은 마치 객체(인스턴스)를 생성하기 위한 템플릿(클래스)처럼 생성자 함수를 사용하여 프로퍼티 구조가 동일한 객체 여러 개를 간편하게 생성할 수 있습니다.
- 생성자 함수는 이름 그대로 객체(인스턴스)를 생성하는 함수입니다.
- 일반 함수와 동일한 방법으로 생성자 함수를 정의하고 new 연산자와 함께 호출하면 해당 함수는 생성자 함수로 동작합니다.

- new 연산자와 함께 생성자 함수를 호출하면 자바스크립트 엔진은 다음과 같은 과정을 거쳐 암묵적으로 인스턴스를 생성하고 인스턴스를 초기화한 후 암묵적으로 인스턴스를 반환합니다.
  - 인스턴스 생성과 this 바인딩
    - 암묵적으로 빈 객체가 생성됩니다.
    - 암묵적으로 생성된 빈 객체, 즉 인스턴스는 this에 바인딩됩니다.
    - 생성자 함수 내부의 this가 생성자 함수가 생성할 인스턴스를 가리키는 이유가 바로 이것입니다.
  - 인스턴스 초기화
    - 생성자 함수에 기술되어 있는 코드가 한 줄씩 실행되어 this에 바인딩되어 있는 인스턴스를 초기화합니다.
    - 즉, this에 바인딩되어 있는 인스턴스에 프로퍼티나 메서드를 추가하고 생성자 함수가 인수로 전달받은 초기값을 인스턴스 프로퍼티에 할당하여 초기화하거나 고정값을 할당합니다.
  - 인스턴스 반환
    - 생성자 함수 내부의 모든 처리가 끝나면 완성된 인스턴스가 바인딩된 this가 암묵적으로 반환됩니다.

### 내부 메서드 [[Call]]과 [[Construct]]

- 함수 선언문 또는 함수 표현식으로 정의한 함수는 일반적인 함수로서 호출할 수 있는 것은 물론 생성자 함수로서 호출할 수 있습니다.
- 생성자 함수로서 호출한다는 것은 new 연산자와 함께 호출하여 객체를 생성하는 것을 의미합니다.
- 함수는 객체이므로 일반 객체와 동일하게 동작할 수 있습니다.
  - 함수는 객체이지만 일반 객체는 호출할 수 없지만 함수는 호출할 수 있습니다.
  - 함수 객체는 일반 객체가 가지고 있는 내부 슬롯과 내부 메서드는 물론, 함수로서 동작하기 위해 함수 객체만을 위한 [[Environment]], [[FormalParameters]]등의 내부 슬롯과 [[Call]], [[Construct]] 같은 내부 메서드를 추가로 가지고 있습니다.
  - 함수가 일반 함수로서 호출되면 함수 객체의 내부 메서드 [[Call]]이 호출되고 new 연산자와 함께 생성자 함수로서 호출되면 내부 메서드 [[Construct]]가 호출됩니다.
- 내부 메서드 [[Call]]을 갖는 함수 객체를 callable이라 하며, 내부 메서드 [[Construct]]를 갖는 함수 객체를 constructor, [[Construct]]를 갖지 않는 함수 객체를 non-constructor라고 부릅니다.
  - Constructor 함수: 함수 선언문, 함수 표현식, 클래스
  - Non-Constructor: 메서드(ES6 메서드 축약 표현), 화살표 함수

### new 연산자

- new 연산자와 함께 함수를 호출하면 해당 함수는 생성자 함수로 동작합니다.
- new 연산자 없이 생성자 함수를 호출하면 일반 함수로 호출됩니다.
- 함수를 new 연산자와 함께 생성자 함수로서 호출하면 함수 내부의 this는 생성자 함수가 생성할 인스턴스를 가리킵니다.
- 하지만 함수를 일반적인 함수로서 호출하면 함수 내부의 this는 전역 객체 window를 가리킵니다.

### new.target

- new 연산자와 함께 생성자 함수로서 호출되면 new.target은 함수 자신을 가리킵니다.
- new 연산자 없이 일반 함수로서 호출된 함수 내부의 new.target은 undefined입니다.
